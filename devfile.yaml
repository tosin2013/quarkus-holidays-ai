schemaVersion: 2.2.0
metadata:
  name: quarkus-holidays-ai
  version: 1.0.0
  displayName: Quarkus Holidays AI
  description: A Quarkus application for holiday information with AI integration
  tags:
    - Java
    - Quarkus
    - AI
projects:
  - name: quarkus-holidays-ai
    git:
      remotes:
        origin: 'https://github.com/tosin2013/quarkus-holidays-ai.git'
components:
  - name: tools
    container:
      image: openjdk:21
      memoryLimit: 2Gi
      cpuLimit: '1000m'  # Corrected to string with unit
      cpuRequest: '500m' # Added cpuRequest as a string with unit
      mountSources: true
      command: ['/bin/sh']
      args: ['-c', 'while sleep 1000; do :; done']
      env:
        - name: MAVEN_OPTS
          value: '-Dmaven.repo.local=/home/user/.m2/repository'
commands:
  - id: install-clis
    exec:
      label: 'Install Quarkus and Kustomize CLI'
      component: tools
      workingDir: /projects/quarkus-holidays-ai
      commandLine: |
        echo "Installing SDKMAN..."
        curl -s "https://get.sdkman.io" | bash
        source "$HOME/.sdkman/bin/sdkman-init.sh"
        echo "Installing Quarkus CLI..."
        sdk install quarkus 3.16.2
        echo "Quarkus CLI installed successfully."
        echo "Installing Kustomize CLI..."
        curl -s "https://raw.githubusercontent.com/kubernetes-sigs/kustomize/master/hack/install_kustomize.sh" | bash
        mv kustomize /usr/local/bin/
        chmod +x /usr/local/bin/kustomize
        echo "Kustomize CLI installed successfully."
  - id: build
    exec:
      component: tools
      commandLine: 'mvn clean install'
      workingDir: /projects/quarkus-holidays-ai
      group:
        kind: build
        isDefault: true
  - id: run
    exec:
      component: tools
      commandLine: 'java -jar target/quarkus-holidays-ai-1.0.0-SNAPSHOT-runner.jar'
      workingDir: /projects/quarkus-holidays-ai
      group:
        kind: run
        isDefault: true
